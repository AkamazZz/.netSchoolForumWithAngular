/**
 * @fileoverview added by tsickle
 * Generated from: lib/dynamic-mat-table/extensions/filter/header-filter.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectionStrategy, Component, HostBinding, Output, ViewChild, Input, EventEmitter, ChangeDetectorRef, QueryList, ContentChildren } from '@angular/core';
import { TableService } from '../../dynamic-mat-table.service';
import { TextFilter } from './compare/text-filter';
import { NumberFilter } from './compare/number-filter';
import { transition, trigger, query, style, stagger, animate } from '@angular/animations';
import { TableIntl } from '../../../international/table-Intl';
import { MatMenuTrigger } from '@angular/material/menu';
import { isNullorUndefined } from '../../../cores/type';
/** @type {?} */
var listAnimation = trigger('listAnimation', [
    transition('* <=> *', [
        query(':enter', [style({ opacity: 0 }), stagger('10ms', animate('400ms ease-out', style({ opacity: 1 })))], { optional: true }),
    ])
]);
var HeaderFilterComponent = /** @class */ (function () {
    function HeaderFilterComponent(languagePack, service, cdr) {
        this.languagePack = languagePack;
        this.service = service;
        this.cdr = cdr;
        this.filterChanged = new EventEmitter();
        this.filterList = [];
    }
    Object.defineProperty(HeaderFilterComponent.prototype, "filters", {
        get: /**
         * @return {?}
         */
        function () {
            if (isNullorUndefined(this.filterList) === true || this.filterList.length === 0) {
                this.filterList = [];
                this.addNewFilter(this.field.type || 'text');
            }
            return this.filterList;
        },
        set: /**
         * @param {?} values
         * @return {?}
         */
        function (values) {
            this.filterList = values;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HeaderFilterComponent.prototype, "hasValue", {
        get: /**
         * @return {?}
         */
        function () {
            return this.filters && this.filters.filter((/**
             * @param {?} f
             * @return {?}
             */
            function (f) { return f.hasValue() === true; })).length > 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HeaderFilterComponent.prototype, "showTrigger", {
        get: /**
         * @return {?}
         */
        function () {
            if (this.menu === undefined) {
                return false;
            }
            else {
                return this.menu.menuOpen || this.hasValue;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    HeaderFilterComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.eventsSubscription) {
            this.eventsSubscription.unsubscribe();
        }
    };
    /**
     * @return {?}
     */
    HeaderFilterComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        if (isNullorUndefined(this.filters)) {
            this.filters = [];
            this.addNewFilter(this.field.type);
        }
    };
    /**
     * @param {?=} type
     * @return {?}
     */
    HeaderFilterComponent.prototype.addNewFilter = /**
     * @param {?=} type
     * @return {?}
     */
    function (type) {
        if (type === void 0) { type = 'text'; }
        switch (type || 'text') {
            case 'text': {
                this.filterList.push(new TextFilter(this.languagePack));
                break;
            }
            case 'number': {
                this.filterList.push(new NumberFilter(this.languagePack));
                break;
            }
            case 'date': {
                // this.compare = new DateCompare(service);
                break;
            }
            case 'boolean': {
                // this.compare = new BooleanCompare(service);
                break;
            }
            default: this.filterList.push(new TextFilter(this.languagePack));
        }
        this.filters[this.filters.length - 1].selectedIndex = 0;
        return this.filters[this.filters.length - 1];
    };
    /**
     * @return {?}
     */
    HeaderFilterComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.menu) {
            this.eventsSubscription = this.menu.menuOpened.subscribe((/**
             * @return {?}
             */
            function () { return _this.focusToLastInput(); }));
        }
    };
    /**
     * @return {?}
     */
    HeaderFilterComponent.prototype.focusToLastInput = /**
     * @return {?}
     */
    function () {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            if (_this.filterInputList.length > 0) {
                _this.filterInputList.last.focus();
            }
        }));
    };
    /**
     * @param {?} index
     * @param {?} action
     * @return {?}
     */
    HeaderFilterComponent.prototype.filterAction_OnClick = /**
     * @param {?} index
     * @param {?} action
     * @return {?}
     */
    function (index, action) {
        var _this = this;
        if (action === 0 || action === 1) { // and or
            this.filters[index].type = action === 0 ? 'and' : 'or';
            if (this.filters.length === index + 1) {
                this.addNewFilter(this.field.type);
                this.focusToLastInput();
            }
        }
        else if (action === 2 && this.filters.length > 1) { // delete
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.filters.splice(index, 1);
                _this.cdr.detectChanges();
                _this.focusToLastInput();
            })); // bug for delete filter item(unwanted reaction close menu)
        }
    };
    /**
     * @return {?}
     */
    HeaderFilterComponent.prototype.clearColumn_OnClick = /**
     * @return {?}
     */
    function () {
        this.filterList = [];
        this.filterChanged.emit(this.filterList);
    };
    /**
     * @return {?}
     */
    HeaderFilterComponent.prototype.applyFilter_OnClick = /**
     * @return {?}
     */
    function () {
        this.filterChanged.emit(this.filterList);
    };
    HeaderFilterComponent.decorators = [
        { type: Component, args: [{
                    // tslint:disable-next-line:component-selector
                    selector: 'header-filter',
                    template: "<ng-content></ng-content>\r\n\r\n<mat-menu filter-event #filterMenu=\"matMenu\" class=\"menu\" >\r\n  <ng-template matMenuContent>\r\n\r\n  <div filter-event class=\"menu-title\">\r\n    {{field?.header}}\r\n  </div>\r\n  <div [@listAnimation]=\"filters.length\" filter-event *ngFor=\"let filter of filters; let index = index\" class=\"filter-panel\">\r\n\r\n    <mat-form-field>\r\n      <mat-select [value]=\"filter.selectedIndex\" [panelClass]=\"'mat-elevation-z10'\" (selectionChange)=\"filter.selectedIndex = $event.value;\" placeholder='Conditions' (keyup.enter)=\"applyFilter_OnClick()\">\r\n        <mat-option *ngFor=\"let op of filter.getOperations(); let selectedIndex=index\" [value]=\"selectedIndex\">\r\n          {{ op.text }}\r\n        </mat-option>\r\n      </mat-select>\r\n    </mat-form-field>\r\n\r\n    <div *ngFor=\"let ctrl of filter?.parameters\">\r\n      <mat-form-field class=\"input-field\">\r\n        <mat-label>{{ctrl.text}}</mat-label>\r\n        <input matInput #filterInput=\"matInput\" [(ngModel)]=\"ctrl.value\" [placeholder]=\"\" (keyup.enter)=\"applyFilter_OnClick()\" autocomplete=\"off\"/>\r\n      </mat-form-field>\r\n    </div>\r\n\r\n    <div class=\"or-and\">\r\n      <span *ngIf=\"filters?.length !== index+1\" class=\"selected-filter-type\">{{ filter?.type === 'and' ? languagePack.filterLabels.And : languagePack.filterLabels.Or}}</span>\r\n      <span class=\"svg\">\r\n        <mat-icon (click)=\"filterAction_OnClick(index,0)\">add</mat-icon>\r\n      </span>\r\n      <span class=\"svg\">\r\n        <mat-icon (click)=\"filterAction_OnClick(index,1)\" style=\"transform: rotate(90deg);\">drag_handle</mat-icon>\r\n      </span>\r\n      <span class=\"svg\">\r\n        <mat-icon (click)=\"filterAction_OnClick(index,2)\">clear</mat-icon>\r\n      </span>\r\n    </div>\r\n\r\n  </div>\r\n\r\n  <div filter-event class=\"menu-action\">\r\n    <button mat-raised-button (click)=\"clearColumn_OnClick()\">{{ languagePack.filterLabels.Clear }}</button>\r\n    <button mat-raised-button color=\"primary\" (click)=\"applyFilter_OnClick()\">{{ languagePack.filterLabels.Search}}</button>\r\n  </div>\r\n</ng-template>\r\n</mat-menu>\r\n\r\n<span class=\"trigger\" [matMenuTriggerFor]=\"filterMenu\" *ngIf=\"field.filterable !== false\">\r\n  <mat-icon>filter_list</mat-icon>\r\n</span>\r\n",
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    animations: [listAnimation],
                    styles: ["@media print{.printpreview{background-color:#fff;position:fixed;width:100%;height:auto;z-index:99999999;margin:0;padding:0;top:0;left:0;overflow:visible;display:block}}.disable-backdrop-click .cdk-overlay-backdrop.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing{pointer-events:none}:host{display:flex;align-items:center;width:100%;align-self:stretch}.trigger{color:rgba(0,0,0,.3);display:flex;opacity:0;transform:translateY(-5px);cursor:pointer;transition-duration:.4s;transition-property:opacity,transform;position:sticky;right:0;z-index:1;padding-left:0 8px}:host.has-value .trigger{color:rgba(0,0,0,.54)}:host.show-trigger .trigger,:host:hover .trigger{opacity:1;transform:translateY(-1px)}::ng-deep.mat-menu-content:not(:empty){padding:0!important}.mat-menu-item-highlighted:not([disabled]),.mat-menu-item.cdk-keyboard-focused:not([disabled]),.mat-menu-item.cdk-program-focused:not([disabled]),.mat-menu-item:hover:not([disabled]){background-color:inherit}.input-field{margin-top:-15px}.menu-title{font-weight:bolder;top:-8px;position:sticky;background-color:#fff;z-index:1}.menu-action{position:sticky;bottom:-8px;padding-top:10px;padding-bottom:0;background-color:#fff}.menu-action button{width:calc(50% - 10px);margin:5px;border-radius:10px}.filter-panel{border-radius:5px;background-color:#fdfbfb;border:1px solid #efefef;transition:.5s;padding:5px;overflow:hidden;font-size:14px;margin-top:10px;display:flex;flex-direction:column}.filter-panel:nth-child(2){margin-top:0!important}.filter-panel:hover{border:1px solid #d1d1d1}.filter-panel:hover .svg{opacity:1;transform:translateY(-1px)}.or-and{display:inherit!important;text-align:right;margin:-12px 0;height:35px;cursor:inherit;font-size:12px}.svg{opacity:0;transform:translateY(-5px);transition-duration:.4s;transition-property:opacity,transform;margin-left:5px;padding:2px;border-radius:5px;color:#4c4c4c;cursor:pointer;display:inline-block!important;height:24px}.svg mat-icon{margin:0;vertical-align:top;border-radius:5px}.svg mat-icon:hover{color:#fff;background-color:#89898a}.svg:hover{background-color:#f8f8f8}.selected-filter-type{float:left;color:#fff;background-color:#89898a;border-radius:5px;padding:0 4px;line-height:24px}::ng-deep .menu{padding:8px;-webkit-user-select:none;-moz-user-select:none;user-select:none}"]
                }] }
    ];
    /** @nocollapse */
    HeaderFilterComponent.ctorParameters = function () { return [
        { type: TableIntl },
        { type: TableService },
        { type: ChangeDetectorRef }
    ]; };
    HeaderFilterComponent.propDecorators = {
        field: [{ type: Input }],
        filterChanged: [{ type: Output }],
        filterInputList: [{ type: ContentChildren, args: ['filterInput',] }],
        menu: [{ type: ViewChild, args: [MatMenuTrigger, { static: true },] }],
        filters: [{ type: Input }],
        hasValue: [{ type: HostBinding, args: ['class.has-value',] }],
        showTrigger: [{ type: HostBinding, args: ['class.show-trigger',] }]
    };
    return HeaderFilterComponent;
}());
export { HeaderFilterComponent };
if (false) {
    /** @type {?} */
    HeaderFilterComponent.prototype.field;
    /** @type {?} */
    HeaderFilterComponent.prototype.filterChanged;
    /** @type {?} */
    HeaderFilterComponent.prototype.filterInputList;
    /** @type {?} */
    HeaderFilterComponent.prototype.menu;
    /**
     * @type {?}
     * @private
     */
    HeaderFilterComponent.prototype.filterList;
    /**
     * @type {?}
     * @private
     */
    HeaderFilterComponent.prototype.eventsSubscription;
    /** @type {?} */
    HeaderFilterComponent.prototype.languagePack;
    /** @type {?} */
    HeaderFilterComponent.prototype.service;
    /**
     * @type {?}
     * @private
     */
    HeaderFilterComponent.prototype.cdr;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVhZGVyLWZpbHRlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9keW5hbWljLW1hdC10YWJsZS8iLCJzb3VyY2VzIjpbImxpYi9keW5hbWljLW1hdC10YWJsZS9leHRlbnNpb25zL2ZpbHRlci9oZWFkZXItZmlsdGVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBaUIsdUJBQXVCLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUNqRixLQUFLLEVBQUUsWUFBWSxFQUFVLGlCQUFpQixFQUFFLFNBQVMsRUFBMkIsZUFBZSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXBJLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUMvRCxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDbkQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBRXZELE9BQU8sRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQzFGLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUU5RCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDeEQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0scUJBQXFCLENBQUM7O0lBR2xELGFBQWEsR0FBRyxPQUFPLENBQUMsZUFBZSxFQUFFO0lBQzdDLFVBQVUsQ0FBQyxTQUFTLEVBQUU7UUFDcEIsS0FBSyxDQUFDLFFBQVEsRUFDWixDQUFDLEtBQUssQ0FBQyxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLE9BQU8sQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLGdCQUFnQixFQUFFLEtBQUssQ0FBQyxFQUFFLE9BQU8sRUFBRSxDQUFDLEVB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STFDLEtBQUs7MkJBWUwsV0FBVyxTQUFDLGlCQUFpQjs4QkFLN0IsV0FBVyxTQUFDLG9CQUFvQjs7SUF3Rm5DLDRCQUFDO0NBQUEsQUExSEQsSUEwSEM7U0FsSFkscUJBQXFCOzs7SUFDaEMsc0NBQWlDOztJQUNqQyw4Q0FBK0Y7O0lBRS9GLGdEQUF1RTs7SUFDdkUscUNBQW9FOzs7OztJQUVwRSwyQ0FBMEM7Ozs7O0lBQzFDLG1EQUF5Qzs7SUEyQjdCLDZDQUE4Qjs7SUFBRSx3Q0FBNEI7Ozs7O0lBQUUsb0NBQThCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWZ0ZXJWaWV3SW5pdCwgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksIENvbXBvbmVudCwgSG9zdEJpbmRpbmcsIE91dHB1dCwgVmlld0NoaWxkLFxyXG4gICAgICAgICBJbnB1dCwgRXZlbnRFbWl0dGVyLCBPbkluaXQsIENoYW5nZURldGVjdG9yUmVmLCBRdWVyeUxpc3QsIFZpZXdDaGlsZHJlbiwgT25EZXN0cm95LCBDb250ZW50Q2hpbGRyZW4gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgVGFibGVGaWVsZCB9IGZyb20gJy4vLi4vLi4vLi4vbW9kZWxzL3RhYmxlLWZpZWxkLm1vZGVsJztcclxuaW1wb3J0IHsgVGFibGVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vZHluYW1pYy1tYXQtdGFibGUuc2VydmljZSc7XHJcbmltcG9ydCB7IFRleHRGaWx0ZXIgfSBmcm9tICcuL2NvbXBhcmUvdGV4dC1maWx0ZXInO1xyXG5pbXBvcnQgeyBOdW1iZXJGaWx0ZXIgfSBmcm9tICcuL2NvbXBhcmUvbnVtYmVyLWZpbHRlcic7XHJcbmltcG9ydCB7IEFic3RyYWN0RmlsdGVyIH0gZnJvbSAnLi9jb21wYXJlL2Fic3RyYWN0LWZpbHRlcic7XHJcbmltcG9ydCB7IHRyYW5zaXRpb24sIHRyaWdnZXIsIHF1ZXJ5LCBzdHlsZSwgc3RhZ2dlciwgYW5pbWF0ZSB9IGZyb20gJ0Bhbmd1bGFyL2FuaW1hdGlvbnMnO1xyXG5pbXBvcnQgeyBUYWJsZUludGwgfSBmcm9tICcuLi8uLi8uLi9pbnRlcm5hdGlvbmFsL3RhYmxlLUludGwnO1xyXG5pbXBvcnQgeyBNYXRJbnB1dCB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2lucHV0JztcclxuaW1wb3J0IHsgTWF0TWVudVRyaWdnZXIgfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9tZW51JztcclxuaW1wb3J0IHsgaXNOdWxsb3JVbmRlZmluZWQgfSBmcm9tICcuLi8uLi8uLi9jb3Jlcy90eXBlJztcclxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XHJcblxyXG5jb25zdCBsaXN0QW5pbWF0aW9uID0gdHJpZ2dlcignbGlzdEFuaW1hdGlvbicsIFtcclxuICB0cmFuc2l0aW9uKCcqIDw9PiAqJywgW1xyXG4gICAgcXVlcnkoJzplbnRlcicsXHJcbiAgICAgIFtzdHlsZSh7IG9wYWNpdHk6IDAgfSksIHN0YWdnZXIoJzEwbXMnLCBhbmltYXRlKCc0MDBtcyBlYXNlLW91dCcsIHN0eWxlKHsgb3BhY2l0eTogMSB9KSkpXSxcclxuICAgICAgeyBvcHRpb25hbDogdHJ1ZSB9XHJcbiAgICApLFxyXG4gIF0pXHJcbl0pO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmNvbXBvbmVudC1zZWxlY3RvclxyXG4gIHNlbGVjdG9yOiAnaGVhZGVyLWZpbHRlcicsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2hlYWRlci1maWx0ZXIuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL2hlYWRlci1maWx0ZXIuY29tcG9uZW50LnNjc3MnXSxcclxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcclxuICBhbmltYXRpb25zOiBbbGlzdEFuaW1hdGlvbl1cclxufSlcclxuZXhwb3J0IGNsYXNzIEhlYWRlckZpbHRlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcclxuICBASW5wdXQoKSBmaWVsZD86IFRhYmxlRmllbGQ8YW55PjtcclxuICBAT3V0cHV0KCkgZmlsdGVyQ2hhbmdlZDogRXZlbnRFbWl0dGVyPEFic3RyYWN0RmlsdGVyW10+ID0gbmV3IEV2ZW50RW1pdHRlcjxBYnN0cmFjdEZpbHRlcltdPigpO1xyXG5cclxuICBAQ29udGVudENoaWxkcmVuKCdmaWx0ZXJJbnB1dCcpIGZpbHRlcklucHV0TGlzdCAhOiBRdWVyeUxpc3Q8TWF0SW5wdXQ+O1xyXG4gIEBWaWV3Q2hpbGQoTWF0TWVudVRyaWdnZXIsIHsgc3RhdGljOiB0cnVlIH0pIG1lbnUgITogTWF0TWVudVRyaWdnZXI7XHJcblxyXG4gIHByaXZhdGUgZmlsdGVyTGlzdDogQWJzdHJhY3RGaWx0ZXJbXSA9IFtdO1xyXG4gIHByaXZhdGUgZXZlbnRzU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XHJcbiAgQElucHV0KClcclxuICBnZXQgZmlsdGVycygpOiBBYnN0cmFjdEZpbHRlcltdIHtcclxuICAgIGlmICggaXNOdWxsb3JVbmRlZmluZWQodGhpcy5maWx0ZXJMaXN0KSA9PT0gdHJ1ZSB8fCB0aGlzLmZpbHRlckxpc3QubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHRoaXMuZmlsdGVyTGlzdCA9IFtdO1xyXG4gICAgICB0aGlzLmFkZE5ld0ZpbHRlcih0aGlzLmZpZWxkLnR5cGUgfHwgJ3RleHQnKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLmZpbHRlckxpc3Q7XHJcbiAgfVxyXG4gIHNldCBmaWx0ZXJzKHZhbHVlczogQWJzdHJhY3RGaWx0ZXJbXSkge1xyXG4gICAgdGhpcy5maWx0ZXJMaXN0ID0gdmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5oYXMtdmFsdWUnKVxyXG4gIGdldCBoYXNWYWx1ZSgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLmZpbHRlcnMgJiYgdGhpcy5maWx0ZXJzLmZpbHRlciggZiA9PiBmLmhhc1ZhbHVlKCkgPT09IHRydWUpLmxlbmd0aCA+IDA7XHJcbiAgfVxyXG5cclxuICBASG9zdEJpbmRpbmcoJ2NsYXNzLnNob3ctdHJpZ2dlcicpXHJcbiAgZ2V0IHNob3dUcmlnZ2VyKCk6IGJvb2xlYW4ge1xyXG4gICAgaWYodGhpcy5tZW51ID09PSB1bmRlZmluZWQpIHsgXHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1lbnUubWVudU9wZW4gfHwgdGhpcy5oYXNWYWx1ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBsYW5ndWFnZVBhY2s6IFRhYmxlSW50bCwgcHVibGljIHNlcnZpY2U6IFRhYmxlU2VydmljZSwgcHJpdmF0ZSBjZHI6IENoYW5nZURldGVjdG9yUmVmKSB7XHJcbiAgfVxyXG5cclxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHsgICAgXHJcbiAgICBpZiAodGhpcy5ldmVudHNTdWJzY3JpcHRpb24pIHtcclxuICAgICAgdGhpcy5ldmVudHNTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgaWYgKGlzTnVsbG9yVW5kZWZpbmVkKHRoaXMuZmlsdGVycykpIHtcclxuICAgICAgdGhpcy5maWx0ZXJzID0gW107XHJcbiAgICAgIHRoaXMuYWRkTmV3RmlsdGVyKHRoaXMuZmllbGQudHlwZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhZGROZXdGaWx0ZXIodHlwZTogc3RyaW5nID0gJ3RleHQnKSB7XHJcbiAgICBzd2l0Y2ggKHR5cGUgfHwgJ3RleHQnKSB7XHJcbiAgICAgIGNhc2UgJ3RleHQnOiB7XHJcbiAgICAgICAgdGhpcy5maWx0ZXJMaXN0LnB1c2gobmV3IFRleHRGaWx0ZXIodGhpcy5sYW5ndWFnZVBhY2spKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjYXNlICdudW1iZXInOiB7XHJcbiAgICAgICAgdGhpcy5maWx0ZXJMaXN0LnB1c2gobmV3IE51bWJlckZpbHRlcih0aGlzLmxhbmd1YWdlUGFjaykpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ2RhdGUnOiB7XHJcbiAgICAgICAgLy8gdGhpcy5jb21wYXJlID0gbmV3IERhdGVDb21wYXJlKHNlcnZpY2UpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ2Jvb2xlYW4nOiB7XHJcbiAgICAgICAgLy8gdGhpcy5jb21wYXJlID0gbmV3IEJvb2xlYW5Db21wYXJlKHNlcnZpY2UpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGRlZmF1bHQ6IHRoaXMuZmlsdGVyTGlzdC5wdXNoKG5ldyBUZXh0RmlsdGVyKHRoaXMubGFuZ3VhZ2VQYWNrKSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmZpbHRlcnNbdGhpcy5maWx0ZXJzLmxlbmd0aCAtIDFdLnNlbGVjdGVkSW5kZXggPSAwO1xyXG4gICAgcmV0dXJuIHRoaXMuZmlsdGVyc1t0aGlzLmZpbHRlcnMubGVuZ3RoIC0gMV07XHJcbiAgfVxyXG5cclxuICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcbiAgICBpZiAodGhpcy5tZW51KSB7XHJcbiAgICAgIHRoaXMuZXZlbnRzU3Vic2NyaXB0aW9uID0gdGhpcy5tZW51Lm1lbnVPcGVuZWQuc3Vic2NyaWJlKCgpID0+IHRoaXMuZm9jdXNUb0xhc3RJbnB1dCgpKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZvY3VzVG9MYXN0SW5wdXQoKSB7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgaWYgKHRoaXMuZmlsdGVySW5wdXRMaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICB0aGlzLmZpbHRlcklucHV0TGlzdC5sYXN0LmZvY3VzKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZmlsdGVyQWN0aW9uX09uQ2xpY2soaW5kZXgsIGFjdGlvbikge1xyXG4gICAgaWYgKGFjdGlvbiA9PT0gMCB8fCBhY3Rpb24gPT09IDEpIHsgLy8gYW5kIG9yXHJcbiAgICAgIHRoaXMuZmlsdGVyc1tpbmRleF0udHlwZSA9IGFjdGlvbiA9PT0gMCA/ICdhbmQnIDogJ29yJztcclxuICAgICAgaWYgKHRoaXMuZmlsdGVycy5sZW5ndGggPT09IGluZGV4ICsgMSkge1xyXG4gICAgICAgIHRoaXMuYWRkTmV3RmlsdGVyKHRoaXMuZmllbGQudHlwZSk7XHJcbiAgICAgICAgdGhpcy5mb2N1c1RvTGFzdElucHV0KCk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSAyICYmIHRoaXMuZmlsdGVycy5sZW5ndGggPiAxKSB7IC8vIGRlbGV0ZVxyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICB0aGlzLmZpbHRlcnMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgdGhpcy5mb2N1c1RvTGFzdElucHV0KCk7XHJcbiAgICAgIH0pOyAvLyBidWcgZm9yIGRlbGV0ZSBmaWx0ZXIgaXRlbSh1bndhbnRlZCByZWFjdGlvbiBjbG9zZSBtZW51KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY2xlYXJDb2x1bW5fT25DbGljaygpIHtcclxuICAgIHRoaXMuZmlsdGVyTGlzdCA9IFtdO1xyXG4gICAgdGhpcy5maWx0ZXJDaGFuZ2VkLmVtaXQodGhpcy5maWx0ZXJMaXN0KTtcclxuICB9XHJcblxyXG4gIGFwcGx5RmlsdGVyX09uQ2xpY2soKSB7XHJcbiAgICB0aGlzLmZpbHRlckNoYW5nZWQuZW1pdCh0aGlzLmZpbHRlckxpc3QpO1xyXG4gIH1cclxuXHJcbn1cclxuXHJcbiJdfQ==